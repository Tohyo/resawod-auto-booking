# Read the documentation at https://www.serverless.com/framework/docs/providers/aws/guide/serverless.yml/
service: Resa-wod

provider:
  name: aws
  # The AWS region in which to deploy (us-east-1 is the default)
  region: eu-west-3
  # The stage of the application, e.g. dev, production, stagingâ€¦ ('dev' is the default)
  stage: production
  runtime: provided.al2
  environment:
    # Symfony environment variables
    APP_ENV: prod

plugins:
  - ./vendor/bref/bref

functions:
  # This function let us run console commands in Lambda
  console:
    handler: bin/console
    timeout: 120 # in seconds
    layers:
      - ${bref:layer.php-81} # PHP
      - ${bref:layer.console} # The "console" layer
    events:
      - schedule:
          rate: cron(0 14 * * ? *)
          input: '"app:resa-wod"'

package:
  patterns:
    # Excluded files and folders for deployment
    - "!assets/**"
    - "!node_modules/**"
    - "!public/build/**"
    - "!tests/**"
    - "!var/**"
    # If you want to include files and folders that are part of excluded folders,
    # add them at the end
    - "var/cache/prod/**"
    - "public/build/entrypoints.json"
    - "public/build/manifest.json"
